# âš™ï¸ Critical Flows (URL shortener system)

This section documents the core end-to-end flows in URL-Shortener system. It emphasizes **session-based authentication**, converting URLs to short URLs and redirecting to the original URLs when a short URL is hit


## ğŸ”‘ 0. User Login (Note: User doesn't have to login to create short URLs, this is only for additional features where the User can view all the short URLs they've created in their dashboard)

**Goal:** Authenticate the user and issue a token for subsequent requests.  

| Step | Component                             | Action                                            |
| ---- | ------------------------------------- | ------------------------------------------------- |
| 1    | **User â†’ API Gateway â†’ Auth Service** | POST `/login` with email/password                 |
| 2    | **Auth Service**                      | Validates credentials, generates JWT              |
| 3    | **API Gateway â†’ User**                | Returns JWT                                       |
| 4    | **User â†’ API Gateway â†’ URL Service**  | Sends requests with `Authorization: Bearer <jwt>` |
| 5    | **API Gateway**                       | Validates token (signature + expiry)              |
| 6    | **URL Service**                       | Uses `user_id` claim to fetch URLs                |

**JWT Token:** A JWT (JSON Web Token) consists of three dot-separated parts â€” header, payload, and signature.  
The signature is generated by hashing (and signing) the header and payload using a secret key or private key.  
When the server validates a request, it recomputes the signature from the header and payload using its own key and compares it against the tokenâ€™s signature.
If they match, the token is authentic and unmodified.
This means an attacker cannot alter the payload (for example, changing "admin": false to "admin": true") â€” because any change to the payload would produce a different signature, and without the secret key, the attacker canâ€™t generate a matching one.
